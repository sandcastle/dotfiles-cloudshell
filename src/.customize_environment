#!/usr/bin/env bash

# Parse arguments
force=0
for arg in "$@"; do
  if [ "$arg" = "--force" ]; then
    force=1
  fi
done

mkdir -p "$HOME/.local/bin"

# Install Starship
if [ "$force" -eq 1 ] || ! command -v starship >/dev/null 2>&1; then
  echo "Installing Starship"
  curl -fsSL https://starship.rs/install.sh | sh -s -- --yes --bin-dir "$HOME/.local/bin"
fi

# Install Neovim
if [ "$force" -eq 1 ] || ! command -v nvim >/dev/null 2>&1; then
  echo "Installing Neovim"
  sudo rm -rf "$HOME/.local/nvim" /tmp/nvim-linux-x86_64.tar.gz
  cd /tmp
  curl -LO https://github.com/neovim/neovim/releases/latest/download/nvim-linux-x86_64.tar.gz
  mkdir -p "$HOME/.local/nvim"
  sudo tar -C "$HOME/.local/nvim" -xzf /tmp/nvim-linux-x86_64.tar.gz
  sudo rm /tmp/nvim-linux-x86_64.tar.gz
  ln -s "$HOME/.local/nvim/bin/nvim" "$HOME/.local/bin/nvim"
fi

# Install zsh
if [ "$force" -eq 1 ] || ! command -v zsh >/dev/null 2>&1; then
  echo "Installing Zsh"
  rm "$HOME/.local/bin/zsh"
  curl -fsSL https://raw.githubusercontent.com/romkatv/zsh-bin/master/install | sh -s -- -d "$HOME/.local"
fi

# Install Mise
if [ "$force" -eq 1 ] || ! command -v mise >/dev/null 2>&1; then
  rm "$HOME/.local/bin/startship"
  curl -sSfL https://mise.jdx.dev/install.sh | sh -s -- --yes --prefix "$HOME/.local"
fi
